{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/groups.service\";\nimport * as i2 from \"src/app/utilities/authentication/authentication.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"../../utilities/loading-spinner/loading-spinner.component\";\n\nfunction EditGroupComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 4);\n    i0.ɵɵelement(1, \"app-loading-spinner\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction EditGroupComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 5);\n    i0.ɵɵlistener(\"click\", function EditGroupComponent_div_2_Template_div_click_0_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return ctx_r3.loadGroups();\n    });\n    i0.ɵɵtext(1, \" Error loading groups - click to retry... \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction EditGroupComponent_div_3_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelementStart(1, \"button\", 24);\n    i0.ɵɵlistener(\"click\", function EditGroupComponent_div_3_div_4_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const i_r6 = i0.ɵɵnextContext().index;\n      const ctx_r14 = i0.ɵɵnextContext();\n      return ctx_r14.commitNameChange(i_r6);\n    });\n    i0.ɵɵtext(2, \"Save Name Change\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 25);\n    i0.ɵɵlistener(\"click\", function EditGroupComponent_div_3_div_4_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const i_r6 = i0.ɵɵnextContext().index;\n      const ctx_r17 = i0.ɵɵnextContext();\n      return ctx_r17.addUser(i_r6);\n    });\n    i0.ɵɵtext(4, \"Add Student\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"button\", 26);\n    i0.ɵɵlistener(\"click\", function EditGroupComponent_div_3_div_4_Template_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const i_r6 = i0.ɵɵnextContext().index;\n      const ctx_r19 = i0.ɵɵnextContext();\n      return ctx_r19.updateGroup(i_r6);\n    });\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const i_r6 = i0.ɵɵnextContext().index;\n    const ctx_r7 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate1(\"id\", \"nameButton\", i_r6, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵclassProp(\"group__button--enabled\", ctx_r7.updatedData[i_r6])(\"group__button--updated\", ctx_r7.updatingData[i_r6]);\n    i0.ɵɵproperty(\"disabled\", !ctx_r7.updatedData[i_r6]);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(!ctx_r7.updatingData[i_r6] ? \"Update Group\" : \"Updating Data...\");\n  }\n}\n\nfunction EditGroupComponent_div_3_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 27);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const group_r5 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"\", group_r5.students.length, \" students\");\n  }\n}\n\nfunction EditGroupComponent_div_3_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r25 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 28);\n    i0.ɵɵlistener(\"click\", function EditGroupComponent_div_3_div_7_Template_div_click_0_listener() {\n      i0.ɵɵrestoreView(_r25);\n      const i_r6 = i0.ɵɵnextContext().index;\n      const ctx_r23 = i0.ɵɵnextContext();\n      return ctx_r23.deleteGroup(i_r6);\n    });\n    i0.ɵɵtext(1, \"\\u2716 \");\n    i0.ɵɵelementStart(2, \"div\", 22);\n    i0.ɵɵtext(3, \"Delete this group\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction EditGroupComponent_div_3_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r28 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 29);\n    i0.ɵɵlistener(\"click\", function EditGroupComponent_div_3_div_8_Template_div_click_0_listener() {\n      i0.ɵɵrestoreView(_r28);\n      const i_r6 = i0.ɵɵnextContext().index;\n      const ctx_r26 = i0.ɵɵnextContext();\n      return ctx_r26.deleteGroupConfirm(i_r6);\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r10 = i0.ɵɵnextContext(2);\n    i0.ɵɵclassProp(\"group__data--buttons--disabled\", ctx_r10.deletingCurrent);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r10.deletingCurrent ? \"Deleting...\" : \"Confirm deletion (irreversible)\");\n  }\n}\n\nfunction EditGroupComponent_div_3_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r30 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 29);\n    i0.ɵɵlistener(\"click\", function EditGroupComponent_div_3_div_9_Template_div_click_0_listener() {\n      i0.ɵɵrestoreView(_r30);\n      const ctx_r29 = i0.ɵɵnextContext(2);\n      return ctx_r29.deleteGroupClear();\n    });\n    i0.ɵɵtext(1, \"Do not delete\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r11 = i0.ɵɵnextContext(2);\n    i0.ɵɵclassProp(\"group__data--buttons--disabled\", ctx_r11.deletingCurrent);\n  }\n}\n\nfunction EditGroupComponent_div_3_th_18_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r35 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"th\", 20);\n    i0.ɵɵelementStart(1, \"div\", 30);\n    i0.ɵɵelementStart(2, \"div\", 31);\n    i0.ɵɵlistener(\"keyup.enter\", function EditGroupComponent_div_3_th_18_Template_div_keyup_enter_2_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r35);\n      const t_r32 = restoredCtx.index;\n      const i_r6 = i0.ɵɵnextContext().index;\n      const ctx_r33 = i0.ɵɵnextContext();\n      return ctx_r33.columnValueChange(i_r6, t_r32, $event);\n    })(\"blur\", function EditGroupComponent_div_3_th_18_Template_div_blur_2_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r35);\n      const t_r32 = restoredCtx.index;\n      const i_r6 = i0.ɵɵnextContext().index;\n      const ctx_r36 = i0.ɵɵnextContext();\n      return ctx_r36.columnValueChange(i_r6, t_r32, $event);\n    });\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 28);\n    i0.ɵɵlistener(\"click\", function EditGroupComponent_div_3_th_18_Template_div_click_4_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r35);\n      const t_r32 = restoredCtx.index;\n      const i_r6 = i0.ɵɵnextContext().index;\n      const ctx_r38 = i0.ɵɵnextContext();\n      return ctx_r38.deleteColumn(i_r6, t_r32);\n    });\n    i0.ɵɵtext(5, \"\\u2716 \");\n    i0.ɵɵelementStart(6, \"div\", 22);\n    i0.ɵɵtext(7, \"Delete this column (cannot be reversed)\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const key_r31 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(key_r31);\n  }\n}\n\nfunction EditGroupComponent_div_3_tr_25_td_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r46 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"td\", 20);\n    i0.ɵɵelementStart(1, \"input\", 33);\n    i0.ɵɵlistener(\"blur\", function EditGroupComponent_div_3_tr_25_td_1_Template_input_blur_1_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r46);\n      const user_r43 = restoredCtx.$implicit;\n      const row_r40 = i0.ɵɵnextContext().$implicit;\n      const i_r6 = i0.ɵɵnextContext().index;\n      const ctx_r44 = i0.ɵɵnextContext();\n      return ctx_r44.userValueChange(i_r6, row_r40.id, user_r43.key, $event.target.value);\n    })(\"keyup.enter\", function EditGroupComponent_div_3_tr_25_td_1_Template_input_keyup_enter_1_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r46);\n      const user_r43 = restoredCtx.$implicit;\n      const row_r40 = i0.ɵɵnextContext().$implicit;\n      const i_r6 = i0.ɵɵnextContext().index;\n      const ctx_r48 = i0.ɵɵnextContext();\n      return ctx_r48.userValueChange(i_r6, row_r40.id, user_r43.key, $event.target.value);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const user_r43 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"value\", user_r43.value);\n  }\n}\n\nfunction EditGroupComponent_div_3_tr_25_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r53 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"tr\", 32);\n    i0.ɵɵtemplate(1, EditGroupComponent_div_3_tr_25_td_1_Template, 2, 1, \"td\", 19);\n    i0.ɵɵpipe(2, \"keyvalue\");\n    i0.ɵɵelementStart(3, \"td\", 20);\n    i0.ɵɵelementStart(4, \"div\", 28);\n    i0.ɵɵlistener(\"click\", function EditGroupComponent_div_3_tr_25_Template_div_click_4_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r53);\n      const s_r41 = restoredCtx.index;\n      const i_r6 = i0.ɵɵnextContext().index;\n      const ctx_r51 = i0.ɵɵnextContext();\n      return ctx_r51.removeUser(i_r6, s_r41);\n    });\n    i0.ɵɵtext(5, \"\\u2716 \");\n    i0.ɵɵelementStart(6, \"div\", 22);\n    i0.ɵɵtext(7, \"Delete this user\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const row_r40 = ctx.$implicit;\n    const i_r6 = i0.ɵɵnextContext().index;\n    const ctx_r13 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind2(2, 1, ctx_r13.sortDataForDisplay(row_r40.data, i_r6), ctx_r13.returnZero));\n  }\n}\n\nfunction EditGroupComponent_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r56 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 6);\n    i0.ɵɵelementStart(1, \"div\", 7);\n    i0.ɵɵelementStart(2, \"div\", 8);\n    i0.ɵɵlistener(\"keyup\", function EditGroupComponent_div_3_Template_div_keyup_2_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r56);\n      const i_r6 = restoredCtx.index;\n      const ctx_r55 = i0.ɵɵnextContext();\n      return ctx_r55.checkNameChange(i_r6, $event);\n    })(\"keyup.enter\", function EditGroupComponent_div_3_Template_div_keyup_enter_2_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r56);\n      const i_r6 = restoredCtx.index;\n      const ctx_r57 = i0.ɵɵnextContext();\n      return ctx_r57.commitNameChange(i_r6);\n    });\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(4, EditGroupComponent_div_3_div_4_Template, 7, 7, \"div\", 9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(5, EditGroupComponent_div_3_div_5_Template, 2, 1, \"div\", 10);\n    i0.ɵɵelementStart(6, \"div\", 11);\n    i0.ɵɵtemplate(7, EditGroupComponent_div_3_div_7_Template, 4, 0, \"div\", 12);\n    i0.ɵɵtemplate(8, EditGroupComponent_div_3_div_8_Template, 2, 3, \"div\", 13);\n    i0.ɵɵtemplate(9, EditGroupComponent_div_3_div_9_Template, 2, 2, \"div\", 13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(10, \"input\", 14);\n    i0.ɵɵelementStart(11, \"label\", 15);\n    i0.ɵɵelementStart(12, \"div\");\n    i0.ɵɵtext(13, \" \\u21E9 \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"div\", 16);\n    i0.ɵɵelementStart(15, \"table\", 17);\n    i0.ɵɵelementStart(16, \"thead\");\n    i0.ɵɵelementStart(17, \"tr\", 18);\n    i0.ɵɵtemplate(18, EditGroupComponent_div_3_th_18_Template, 8, 1, \"th\", 19);\n    i0.ɵɵelementStart(19, \"th\", 20);\n    i0.ɵɵelementStart(20, \"div\", 21);\n    i0.ɵɵlistener(\"click\", function EditGroupComponent_div_3_Template_div_click_20_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r56);\n      const i_r6 = restoredCtx.index;\n      const ctx_r58 = i0.ɵɵnextContext();\n      return ctx_r58.addColumn(i_r6);\n    });\n    i0.ɵɵtext(21, \"\\u271A \");\n    i0.ɵɵelementStart(22, \"div\", 22);\n    i0.ɵɵtext(23, \"Add a new column\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(24, \"tbody\");\n    i0.ɵɵtemplate(25, EditGroupComponent_div_3_tr_25_Template, 8, 4, \"tr\", 23);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const group_r5 = ctx.$implicit;\n    const i_r6 = ctx.index;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate1(\"id\", \"grpId\", i_r6, \"\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(group_r5.name);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.deletionConfirm !== i_r6);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.deletionConfirm !== i_r6);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.deletionConfirm !== i_r6);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.deletionConfirm === i_r6);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.deletionConfirm === i_r6);\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate1(\"name\", \"chk\", i_r6, \"\");\n    i0.ɵɵpropertyInterpolate1(\"id\", \"chk\", i_r6, \"\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate1(\"for\", \"chk\", i_r6, \"\");\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"ngForOf\", group_r5.keys);\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"ngForOf\", group_r5.students);\n  }\n}\n\nexport let EditGroupComponent = /*#__PURE__*/(() => {\n  class EditGroupComponent {\n    constructor(groupsService, auth, groupService) {\n      this.groupsService = groupsService;\n      this.auth = auth;\n      this.groupService = groupService;\n      this.groups = [];\n      this.createNewGroup = false;\n      this.isLoading = false;\n      this.loadingFailure = false;\n      this.updatedData = [];\n      this.updatingData = [];\n      this.deletionConfirm = -1;\n      this.deletingCurrent = false; // get the user info...\n\n      auth.user.subscribe(user => {\n        this.user = user;\n      });\n    }\n\n    ngOnInit() {\n      this.loadGroups();\n    }\n    /**\r\n     * load the groups database...\r\n     */\n\n\n    loadGroups() {\n      this.isLoading = true; // subscribe to the load even in the group service which returns exactly one set of results.\n\n      this.groupService.getGroups().subscribe(groups => {\n        this.groups = groups; // set the updated fields to false;\n\n        for (let i = 0; i < groups.length; i++) {\n          this.updatedData.push(false);\n          this.updatingData.push(false);\n        } // set it to loaded...\n\n\n        this.loadingFailure = false;\n        this.isLoading = false;\n      }, error => {\n        console.log(`Error loading groups: ${error.message}`);\n        this.loadingFailure = true;\n        this.isLoading = false;\n      });\n    }\n\n    updateGroup(groupIndex) {\n      let group = {\n        name: this.groups[groupIndex].name,\n        keys: this.groups[groupIndex].keys,\n        managers: this.groups[groupIndex].managers,\n        students: []\n      };\n      let students = [];\n      this.updatingData[groupIndex] = true;\n      this.updatedData[groupIndex] = false;\n      this.groups[groupIndex].students.forEach(student => {\n        students.push(student);\n      });\n      group.students = students;\n      this.groupsService.updateGroup(group, this.groups[groupIndex].id).subscribe(() => {\n        console.log(`Successfully modified data`);\n        this.updatedData[groupIndex] = false;\n      }, error => {\n        console.log(`Error: ${error.message}`);\n        this.updatedData[groupIndex] = true; // data not updated...\n      }, () => {\n        this.updatingData[groupIndex] = false;\n      });\n    }\n    /**\r\n         * Returns the position of a user within their group.\r\n         * @param userId\r\n         */\n\n\n    getIndexPositionById(userId, groupId) {\n      const index = this.groups[groupId].students.findIndex(temp => temp.id === userId);\n      return index;\n    }\n    /**\r\n     * Chnage a value for one of the users.\r\n     * This does not impact any users already in a report...\r\n     * @param index\r\n     * @param key\r\n     * @param input\r\n     */\n\n\n    userValueChange(groupId, studentId, key, input) {\n      const newValue = input.split(\"\\n\");\n      const studentIndex = this.getIndexPositionById(studentId, groupId);\n\n      if (studentIndex !== -1) {\n        this.updatedData[groupId] = true;\n        this.groups[groupId].students[studentIndex].data[key] = newValue[0];\n      }\n    }\n    /**\r\n     * Add a user\r\n     * @param groupIndex\r\n     */\n\n\n    addUser(groupIndex) {\n      // new user template\n      let newUserTemplate = {\n        id: this.groupService.generateRandomId(),\n        data: {}\n      };\n      this.updatedData[groupIndex] = true; // add the keys to the new user in the right order...\n\n      this.groups[groupIndex].keys.forEach(key => {\n        newUserTemplate.data[key] = \"\";\n      });\n      this.groups[groupIndex].students.push(newUserTemplate);\n    }\n    /**\r\n     * Remove a user\r\n     * @param index\r\n     */\n\n\n    removeUser(groupIndex, index) {\n      this.updatedData[groupIndex] = true;\n      this.groups[groupIndex].students.splice(index, 1);\n    }\n    /**\r\n     * Chnage one of the column values - the titles.\r\n     * This needs to change each of the values in each of the user entries too.\r\n     * @param index\r\n     * @param input\r\n     */\n\n\n    columnValueChange(groupIndex, index, input) {\n      const reference = input.target;\n      const newKeyArray = [...this.groups[groupIndex].keys];\n      const newValue = reference.innerText.split(\"\\n\");\n      newKeyArray[index] = newValue[0];\n      let newData = [];\n      this.updatedData[groupIndex] = true; // iterate over the data and build a new array\n\n      this.groups[groupIndex].students.forEach(row => {\n        let newDataUser = {\n          id: row.id,\n          data: {}\n        }; // go through the array line by line changing the key values...\n\n        this.groups[groupIndex].keys.forEach((key, i) => {\n          const newKey = {\n            [('' + newKeyArray[`${i}`]).trim()]: row.data[`${key}`]\n          };\n          newDataUser.data = Object.assign(Object.assign({}, newDataUser.data), newKey);\n        }); // add ot the new array\n\n        newData.push(newDataUser);\n      });\n      this.groups[groupIndex].keys = newKeyArray;\n      this.groups[groupIndex].students = newData;\n    }\n    /**\r\n     * Adds a new column to the data - will name it col length...\r\n     */\n\n\n    addColumn(groupIndex) {\n      // add to the keys...\n      const colName = `Column ${this.groups[groupIndex].keys.length + 1}`;\n      this.groups[groupIndex].keys.push(colName);\n      this.updatedData[groupIndex] = true; // iterate over and add to each of the userdata...\n\n      this.groups[groupIndex].students.forEach(row => {\n        row.data[colName] = \"\";\n      }); // let newData = [...this.groups];\n      // // iterate over and add to each of the userdata...\n      // newData[groupIndex].students.forEach((row: Student) => {\n      //     row.data[colName] = \"\";\n      // });\n      // this.groups = newData;\n\n      console.log(this.groups);\n    }\n    /**\r\n     * removes a column\r\n     * @param index\r\n     */\n\n\n    deleteColumn(groupIndex, index) {\n      // strip from the keys array\n      const colName = this.groups[groupIndex].keys[index];\n      this.updatedData[groupIndex] = true; // and remove from each of the user data array\n\n      this.groups[groupIndex].students.forEach(row => {\n        delete row.data[colName];\n      });\n      this.groups[groupIndex].keys.splice(index, 1);\n    }\n\n    deleteGroup(groupIndex) {\n      this.deletionConfirm = groupIndex;\n    }\n\n    deleteGroupClear() {\n      this.deletionConfirm = -1;\n    }\n    /**\r\n     * Deletes an entire group...\r\n     * @param groupIndex\r\n     */\n\n\n    deleteGroupConfirm(groupIndex) {\n      this.deletingCurrent = true;\n      this.groupsService.deleteGroup(this.groups[groupIndex].id).subscribe(() => {\n        console.log(\"deletion complete\");\n        this.groups.splice(groupIndex, 1);\n      }, error => {\n        console.log(`Error: ${error.message}`);\n      }, () => {\n        this.deletionConfirm = -1;\n        this.deletingCurrent = false;\n      });\n    }\n    /**\r\n     * Checks to see if the name of the group hasbeen changed and adjusts the visiblity\r\n     * of the button accoridnly.\r\n     * @param groupIndex\r\n     * @param input\r\n     */\n\n\n    checkNameChange(groupIndex, input) {\n      const reference = input.target;\n      const newValue = reference.innerText.split(\"\\n\");\n\n      if (this.groups[groupIndex].name !== newValue[0]) {\n        document.getElementById('nameButton' + groupIndex).style.display = \"inline-block\";\n      } else {\n        document.getElementById('nameButton' + groupIndex).style.display = \"none\";\n      }\n    }\n    /**\r\n     * Commits the name change to the group. Doesnt update the database...\r\n     * @param groupIndex\r\n     */\n\n\n    commitNameChange(groupIndex) {\n      // get the vaue and commit\n      const newValue = document.getElementById('grpId' + groupIndex).innerText.split(\"\\n\");\n      this.groups[groupIndex].name = newValue[0]; // flag for db update\n\n      this.updatedData[groupIndex] = true; // hide the save button\n\n      document.getElementById('nameButton' + groupIndex).style.display = \"none\";\n    }\n    /**\r\n     * keyvalue pipe orders alphabetically automatically. This stop that.\r\n     * @returns number 0\r\n     */\n\n\n    returnZero() {\n      return 0;\n    }\n\n    sortDataForDisplay(data, groupId) {\n      let returnValue = {}; // sort the data into the same order as the keys.,..\n\n      this.groups[groupId].keys.forEach(key => {\n        const newKey = {\n          ['' + key]: data[key]\n        };\n        returnValue = Object.assign(Object.assign({}, returnValue), newKey);\n      });\n      return returnValue;\n    }\n\n  }\n\n  EditGroupComponent.ɵfac = function EditGroupComponent_Factory(t) {\n    return new (t || EditGroupComponent)(i0.ɵɵdirectiveInject(i1.GroupsService), i0.ɵɵdirectiveInject(i2.AuthenticationService), i0.ɵɵdirectiveInject(i1.GroupsService));\n  };\n\n  EditGroupComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: EditGroupComponent,\n    selectors: [[\"app-edit-group\"]],\n    decls: 4,\n    vars: 3,\n    consts: [[1, \"groups\"], [\"class\", \"loading\", 4, \"ngIf\"], [\"class\", \"groups__load-failure\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"group\", 4, \"ngFor\", \"ngForOf\"], [1, \"loading\"], [1, \"groups__load-failure\", 3, \"click\"], [1, \"group\"], [1, \"group__name\"], [\"contenteditable\", \"true\", 1, \"group__name--name\", 3, \"id\", \"keyup\", \"keyup.enter\"], [4, \"ngIf\"], [\"class\", \"group__student-count\", 4, \"ngIf\"], [1, \"group__delete\"], [\"class\", \"group__data--buttons group__data--buttons-remove tooltipped\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"group__data--buttons group__data--buttons-delete tooltipped\", 3, \"group__data--buttons--disabled\", \"click\", 4, \"ngIf\"], [\"type\", \"checkbox\", 3, \"name\", \"id\"], [1, \"group__dropdown-button\", 3, \"for\"], [1, \"group__data\"], [1, \"group__data--table\"], [1, \"group__data--row\", \"group__data--header\"], [\"class\", \"group__data--cell\", 4, \"ngFor\", \"ngForOf\"], [1, \"group__data--cell\"], [1, \"group__data--buttons\", \"group__data--buttons-addcol\", \"tooltipped\", 3, \"click\"], [1, \"tooltip\"], [\"class\", \"group__data--row group__data--data\", 4, \"ngFor\", \"ngForOf\"], [1, \"group__button--button\", \"group__button--enabled\", \"group__button--hidden\", 3, \"id\", \"click\"], [1, \"group__button--button\", \"group__button--enabled\", 3, \"click\"], [1, \"group__button--button\", \"group__button--update\", 3, \"disabled\", \"click\"], [1, \"group__student-count\"], [1, \"group__data--buttons\", \"group__data--buttons-remove\", \"tooltipped\", 3, \"click\"], [1, \"group__data--buttons\", \"group__data--buttons-delete\", \"tooltipped\", 3, \"click\"], [1, \"group__data--cell--header\"], [\"contenteditable\", \"true\", 3, \"keyup.enter\", \"blur\"], [1, \"group__data--row\", \"group__data--data\"], [1, \"group__input\", 3, \"value\", \"blur\", \"keyup.enter\"]],\n    template: function EditGroupComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵtemplate(1, EditGroupComponent_div_1_Template, 2, 0, \"div\", 1);\n        i0.ɵɵtemplate(2, EditGroupComponent_div_2_Template, 2, 0, \"div\", 2);\n        i0.ɵɵtemplate(3, EditGroupComponent_div_3_Template, 26, 12, \"div\", 3);\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.isLoading);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.loadingFailure && !ctx.isLoading);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.groups);\n      }\n    },\n    directives: [i3.NgIf, i3.NgForOf, i4.LoadingSpinnerComponent],\n    pipes: [i3.KeyValuePipe],\n    styles: [\".groups[_ngcontent-%COMP%]{position:relative;background-color:#fff9;border-radius:1rem;min-height:8rem;box-shadow:0 .2rem .4rem #00000080}.groups__load-failure[_ngcontent-%COMP%]{padding:2rem;text-align:center;width:100%;font-size:1.6rem;color:red;transition:all .2s}.groups__load-failure[_ngcontent-%COMP%]:hover{cursor:pointer;letter-spacing:.1rem;font-weight:bold}.group[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr minmax(11rem,max-content) max-content 2rem;align-items:baseline;padding:.5rem 2rem;font-size:1.5rem;background-image:linear-gradient(to right,var(--color-style-main) 0%,var(--color-style-dark) 30%);overflow:none}.group[_ngcontent-%COMP%]:first-of-type{border-radius:1rem 1rem 0 0}.group[_ngcontent-%COMP%]:first-of-type   .group__dropdown-button[_ngcontent-%COMP%]{border-radius:0 1rem 0 0}.group[_ngcontent-%COMP%]:last-of-type{border-radius:0 0 1rem 1rem}.group[_ngcontent-%COMP%]:last-of-type   .group__dropdown-button[_ngcontent-%COMP%]{border-radius:0 0 1rem}.group__name[_ngcontent-%COMP%]{grid-column:1/2;font-weight:bold;display:flex;justify-content:space-between;align-items:baseline}.group__name--name[_ngcontent-%COMP%]{padding-right:1rem}.group__student-count[_ngcontent-%COMP%]{grid-column:2/3;margin:0 1.5rem;font-size:1.4rem}.group__delete[_ngcontent-%COMP%]{grid-column:3/4;margin-right:3rem;display:flex}.group__dropdown-button[_ngcontent-%COMP%]{grid-column:4/5;padding:1rem;margin:-.5rem -2rem;text-align:center;background-image:linear-gradient(to right,var(--color-style-dark) 10%,transparent 50%);background-color:var(--color-style-main);transition:all .2s;align-self:stretch}.group__dropdown-button[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{transform:translate(.5rem)}.group__dropdown-button[_ngcontent-%COMP%]:hover{background-color:var(--color-style-juxtapose);cursor:pointer}.group__data[_ngcontent-%COMP%]{margin-top:0;padding-top:.5rem;font-size:1.4rem}.group__data--table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;position:relative}.group__data--table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{animation:fadeIn .3s ease-in 0s 1 forwards}.group__data--table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-of-type(odd), .group__data--table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-of-type(odd), .group__data--table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-of-type(odd), .group__data--table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-of-type(odd){background-color:#fff3}.group__data--table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0}.group__data--edited[_ngcontent-%COMP%]{font-weight:bold;background-color:red;animation:glow 2s linear 0 1 normal}.group__data--row[_ngcontent-%COMP%]{transition:all .2s}.group__data--row[_ngcontent-%COMP%]:hover{background-color:var(--color-style-juxtapose)}.group__data--header[_ngcontent-%COMP%]{font-weight:bold;background-color:green;background-color:var(--color-style-dark);color:#fff}.group__data--data[_ngcontent-%COMP%]{background-color:var(--color-style-main)}.group__data--cell[_ngcontent-%COMP%]{padding:.5rem 1rem;transition:all .2s}.group__data--cell--header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.group__data--cell[_ngcontent-%COMP%]:last-of-type{display:flex;justify-content:flex-end}.group__data--cell[_ngcontent-%COMP%]:focus{background-color:#ffffff80;font-weight:bold;animation:glow 2s ease-in-out 0 infinite}.group__data--cell[_ngcontent-%COMP%]:visited{background-color:red}.group__data--buttons[_ngcontent-%COMP%]{padding:.1rem .5rem;font-size:1.6rem;transition:all .2s;border:.2rem solid transparent;text-align:center;border-radius:1rem}.group__data--buttons[_ngcontent-%COMP%]:hover{cursor:pointer;border:.2rem solid white;filter:brightness(130%)}.group__data--buttons-remove[_ngcontent-%COMP%]{width:3rem;background-color:red}.group__data--buttons-delete[_ngcontent-%COMP%]{width:auto;font-size:1.4rem;background-color:red;padding:.5rem 1rem}.group__data--buttons-delete[_ngcontent-%COMP%]:not(:last-of-type){margin-right:.5rem}.group__data--buttons--disabled[_ngcontent-%COMP%]{background-color:#f006}.group__data--buttons--disabled[_ngcontent-%COMP%]:hover{cursor:default;border:.2rem solid transparent;filter:brightness(100%)}.group__data--buttons-addcol[_ngcontent-%COMP%]{background-color:green}.group__buttons[_ngcontent-%COMP%]{padding-top:1rem}.group__buttons--left[_ngcontent-%COMP%]{text-align:left}.group__buttons--right[_ngcontent-%COMP%]{text-align:right}.group__button--button[_ngcontent-%COMP%]{font-size:1.4rem;width:auto;padding:.5rem 1rem;border-radius:1rem;transition:all .2s;border:.2rem solid transparent;margin-right:.5rem}.group__button--hidden[_ngcontent-%COMP%]{display:none}.group__button--update[_ngcontent-%COMP%]{width:14rem}.group__button--enabled[_ngcontent-%COMP%]:hover{cursor:pointer;background-color:var(--color-style-juxtapose);color:#fff;border:.2rem solid white;box-shadow:0 .3rem .6rem #0000004d}.group__button--updated[_ngcontent-%COMP%]{background-color:#00800080}.group[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{display:none}.group__input[_ngcontent-%COMP%]{width:100%;padding:.5rem 2rem;background-color:#ffffff4d;border-radius:1rem 2rem;box-shadow:0 .2rem .4rem #0006;font-size:1.4rem;letter-spacing:.3rem}.group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked ~ .group__data[_ngcontent-%COMP%]{visibility:visible;opacity:1;display:flex}.group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked ~ .group__dropdown-button[_ngcontent-%COMP%]{border-bottom-right-radius:0}.group__data[_ngcontent-%COMP%]{grid-column:1/-1;visibility:hidden;opacity:0;display:none;flex-direction:column;margin-top:2rem}\"]\n  });\n  return EditGroupComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}